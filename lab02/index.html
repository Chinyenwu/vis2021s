<html><head>
		<script src="https://d3js.org/d3.v4.js"></script>
        <script src="dataLoader.js"></script>
        <script src="getNode.js"></script>

		<style>
      		@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@900&display=swap');

		    div, ul {
		      border: solid black 1px;
		      margin: 5px;
		      padding: 10px;
		      background-color: rgba(255, 255, 128, 0.1);
		    }

		    div:hover, ul:hover {
		      background-color: rgba(255, 128, 128, 0.1);
		    }

			html, body {
				height: 100%;
				width: 100%;
				padding: 0;
				margin: 0;
				padding: 10px;
		        background-color: rgba(255, 255, 0, 0.02);
			}

			svg {
		        font-family: 'Noto Serif JP', serif;
			}

			#dropfile {
				height: 5%;
				width: 100%;
				border-style: dotted;;
				display: block;
				text-align: center;
			    animation-name: oxxo;
			    animation-duration: 2s;
			    animation-iteration-count: infinite;
			    padding: 10px;
		        background-color: rgba(255, 255, 0, 0.1);
		        font-family: 'Noto Serif JP', serif;
		        margin-bottom: 10px;
			}
			#dropfile:hover {
			    background-color: rgba(128, 255, 255, 0.1);
			}
			@keyframes oxxo{
			    from {
			        border-style: dotted;;
			        border-color: blue;
			        color: blue;
			    }
			    to {
			        border-style: solid;
			        border-color: red;
			        color: crimson;
			    }
			}

			#treemap {
				height: 95%;
				width: 100%;
			}
		</style>
	</head>
	<body>
		<div>
			Lab 02 treemap
		</div>
		<ul>
			<li>遠距教學授課防疫演練: 2021.03.18 (四) </li>
			<li>上台報告: 2021.04.01 (四) </li>
			<li><a href="https://www.d3-graph-gallery.com/graph/treemap_custom.html">Treemap customization in d3.js</a></li>
			<li><a href="http://blog.infographics.tw/2015/10/d3js-tutorial-treemap-and-budget/">D3.js 實戰 － 利用 Treemap Layout 將政府預算視覺化</a></li>
		</ul>

		<div id="dropfile" for="csvfile">
			CSV 資料扔過來! Drop your CSV here.
		</div>
		<div>
			<select id="ObjectKeys"><option value="觀光遊憩區別">觀光遊憩區別</option><option value="門票收入">門票收入</option><option value="遊客人次">遊客人次</option><option value="上年同月份遊客人次">上年同月份遊客人次</option><option value="增減數">增減數</option><option value="成長率">成長率</option><option value="備註">備註</option></select>
		</div>
		<div id="treemap"><div><svg width="1923" height="894"><g><rect x="0" y="70" width="272.05097380402333" height="336.4021534366699" style="stroke: red; fill: rgb(177, 157, 76); opacity: 1;"></rect><rect x="0" y="411.4021534366699" width="272.05097380402333" height="68.46381698119484" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.509489;"></rect><rect x="277.05097380402333" y="70" width="141.01430225357" height="136.9385584379147" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.511946;"></rect><rect x="277.05097380402333" y="211.9385584379147" width="141.01430225357" height="130.19328108231787" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.505438;"></rect><rect x="277.05097380402333" y="347.1318395202326" width="141.01430225357" height="132.73413089763216" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.50789;"></rect><rect x="420.56527605759334" y="344.6318395202326" width="0" height="0" style="stroke: red; fill: rgb(177, 157, 76);"></rect><rect x="0" y="519.8659704178647" width="251.13345503487426" height="275.23972686767706" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.855023;"></rect><rect x="0" y="800.1056972855417" width="251.13345503487426" height="73.89430271445826" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.510138;"></rect><rect x="256.13345503487426" y="519.8659704178647" width="80.62538194083021" height="235.09523907407083" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.512484;"></rect><rect x="341.75883697570447" y="519.8659704178647" width="76.30643908188881" height="235.09523907407083" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.505549;"></rect><rect x="256.13345503487426" y="759.9612094919355" width="161.93182102271908" height="114.0387905080645" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.50789;"></rect><rect x="420.56527605759334" y="757.4612094919355" width="0" height="0" style="stroke: red; fill: rgb(189, 179, 18);"></rect><rect x="438.0652760575933" y="70" width="169.9925907977261" height="102.39805793794005" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507895;"></rect><rect x="438.0652760575933" y="177.39805793794005" width="169.9925907977261" height="104.09519046878995" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.509995;"></rect><rect x="613.0578668553194" y="70" width="169.99259079772605" height="104.29247774837603" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.510239;"></rect><rect x="613.0578668553194" y="179.29247774837603" width="169.99259079772605" height="102.20077065835403" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507651;"></rect><rect x="788.0504576530454" y="70" width="81.80979276065932" height="211.49324840673023" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507894;"></rect><rect x="785.5504576530454" y="283.99324840673023" width="0" height="0" style="stroke: red; fill: rgb(86, 106, 194);"></rect><rect x="438.0652760575933" y="321.49324840673006" width="224.6866889092334" height="194.42509110021348" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.686564;"></rect><rect x="438.0652760575933" y="520.9183395069435" width="224.6866889092334" height="93.62623486595021" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.529085;"></rect><rect x="667.7519649668267" y="321.49324840673006" width="106.72987029428725" height="198.71486563523894" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.529819;"></rect><rect x="779.4818352611139" y="321.49324840673006" width="90.37841515259095" height="198.71486563523894" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.507161;"></rect><rect x="667.7519649668267" y="525.208114041969" width="202.10828544687809" height="89.33646033092475" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.507895;"></rect><rect x="872.3602504137048" y="522.708114041969" width="0" height="0" style="stroke: red; fill: rgb(216, 163, 72);"></rect><rect x="438.0652760575933" y="654.5445743728937" width="171.32393048152397" height="102.11595283438544" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.507895;"></rect><rect x="438.0652760575933" y="761.6605272072792" width="171.32393048152397" height="112.33947279272081" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.520579;"></rect><rect x="614.3892065391173" y="654.5445743728937" width="171.32393048152403" height="111.1530623636329" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.519107;"></rect><rect x="614.3892065391173" y="770.6976367365266" width="171.32393048152403" height="103.30236326347335" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.509367;"></rect><rect x="790.7131370206413" y="654.5445743728937" width="79.14711339306348" height="219.45542562710625" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.507896;"></rect><rect x="788.2131370206413" y="876.5" width="0" height="0" style="stroke: red; fill: rgb(68, 207, 235);"></rect><rect x="889.8602504137048" y="70" width="158.95951646985714" height="111.14896773298943" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.507895;"></rect><rect x="889.8602504137048" y="186.14896773298943" width="158.95951646985714" height="122.67029886318534" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.521078;"></rect><rect x="1053.819766883562" y="70" width="120.32818277000456" height="160.146929090595" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.519436;"></rect><rect x="1179.1479496535665" y="70" width="111.73801414495006" height="160.146929090595" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.509536;"></rect><rect x="1053.819766883562" y="235.146929090595" width="237.06619691495462" height="73.67233750557972" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.507896;"></rect><rect x="1293.3859637985165" y="235.146929090595" width="0" height="73.67233750557972" style="stroke: red; fill: rgb(197, 65, 128);"></rect><rect x="889.8602504137048" y="348.8192665961747" width="160.19922122400408" height="110.80260240547352" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.507895;"></rect><rect x="889.8602504137048" y="464.62186900164824" width="160.19922122400408" height="132.15684209605553" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.532401;"></rect><rect x="1055.0594716377088" y="348.8192665961747" width="123.64632580918692" height="168.52203596025305" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.530073;"></rect><rect x="1183.7057974468958" y="348.8192665961747" width="107.18016635162076" height="168.52203596025305" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.510224;"></rect><rect x="1055.0594716377088" y="522.3413025564278" width="235.82649216080767" height="74.437408541276" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.507896;"></rect><rect x="1293.3859637985165" y="519.8413025564278" width="0" height="0" style="stroke: red; fill: rgb(14, 203, 126);"></rect><rect x="889.8602504137048" y="636.7787110977038" width="158.73541074260493" height="111.21170204693999" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.507895;"></rect><rect x="889.8602504137048" y="752.9904131446438" width="158.73541074260493" height="121.00958685535625" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.5191;"></rect><rect x="1053.5956611563097" y="636.7787110977038" width="158.73541074260493" height="124.08284344842184" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.522614;"></rect><rect x="1053.5956611563097" y="765.8615545461256" width="158.73541074260493" height="108.1384454538744" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.504381;"></rect><rect x="1217.3310718989146" y="636.7787110977038" width="73.5548918996019" height="237.22128890229624" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.507893;"></rect><rect x="1217.3310718989146" y="876.5" width="73.5548918996019" height="0" style="stroke: red; fill: rgb(254, 204, 146);"></rect><rect x="1310.8859637985165" y="70" width="123.32865911543377" height="147.96000432444424" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.507895;"></rect><rect x="1439.2146229139503" y="70" width="155.3382190530233" height="147.96000432444424" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.541044;"></rect><rect x="1310.8859637985165" y="222.96000432444424" width="194.8316459252287" height="123.56562355735167" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.548939;"></rect><rect x="1310.8859637985165" y="351.5256278817959" width="194.8316459252287" height="87.39280736851072" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.5;"></rect><rect x="1510.7176097237452" y="222.96000432444424" width="83.83523224322835" height="215.95843092586233" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.507893;"></rect><rect x="1508.2176097237452" y="441.4184352503066" width="0" height="0" style="stroke: red; fill: rgb(128, 178, 121);"></rect><rect x="1614.5528419669736" y="70" width="125.3495530937239" height="144.87983097522527" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.507895;"></rect><rect x="1744.9023950606975" y="70" width="128.09760493930253" height="144.87983097522527" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.510697;"></rect><rect x="1614.5528419669736" y="219.87983097522527" width="171.24380246723945" height="107.94624880951795" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.510407;"></rect><rect x="1614.5528419669736" y="332.82607978474323" width="171.24380246723945" height="106.0923554655634" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.508185;"></rect><rect x="1790.796644434213" y="219.87983097522527" width="82.20335556578698" height="219.03860427508135" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.507896;"></rect><rect x="1788.296644434213" y="441.41843525030663" width="0" height="0" style="stroke: red; fill: rgb(181, 251, 153);"></rect><rect x="1310.8859637985165" y="478.91843525030663" width="158.89910025659174" height="110.81948478704078" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.507895;"></rect><rect x="1310.8859637985165" y="594.7379200373474" width="158.89910025659174" height="116.63511632549705" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.514568;"></rect><rect x="1474.7850640551083" y="478.91843525030663" width="158.89910025659174" height="119.74894020813178" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.518141;"></rect><rect x="1474.7850640551083" y="603.6673754584384" width="158.89910025659174" height="107.70566090440605" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.504322;"></rect><rect x="1638.6841643117" y="478.91843525030663" width="74.94059295575835" height="232.45460111253783" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.507892;"></rect><rect x="1638.6841643117" y="713.8730363628445" width="74.94059295575835" height="0" style="stroke: red; fill: rgb(177, 71, 16);"></rect><rect x="1310.8859637985165" y="751.3730363628445" width="128.93041110669583" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.507895;"></rect><rect x="1444.8163749052123" y="751.3730363628445" width="134.87797125555016" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.513797;"></rect><rect x="1584.6943461607625" y="751.3730363628445" width="128.93041110669583" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.507895;"></rect><rect x="1716.1247572674583" y="751.3730363628445" width="0" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="1716.1247572674583" y="751.3730363628445" width="0" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="1716.1247572674583" y="751.3730363628445" width="0" height="122.62696363715554" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="1733.6247572674583" y="478.91843525030663" width="139.37524273254166" height="125.29232220442088" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.507895;"></rect><rect x="1733.6247572674583" y="609.2107574547275" width="139.37524273254166" height="134.4969203408507" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.517284;"></rect><rect x="1733.6247572674583" y="748.7076777955782" width="139.37524273254166" height="125.29232220442088" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.507895;"></rect><rect x="1875.5" y="748.7076777955782" width="0" height="125.29232220442088" style="stroke: red; fill: rgb(63, 195, 120);"></rect><rect x="1875.5" y="748.7076777955782" width="0" height="125.29232220442088" style="stroke: red; fill: rgb(63, 195, 120);"></rect><rect x="1875.5" y="748.7076777955782" width="0" height="125.29232220442088" style="stroke: red; fill: rgb(63, 195, 120);"></rect><text x="1" y="90" font-size="1rem" fill="white">門票收入</text><text x="1" y="431.4021534366699" font-size="1rem" fill="white">遊客人次</text><text x="278.05097380402333" y="90" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="278.05097380402333" y="231.9385584379147" font-size="1rem" fill="white">增減數</text><text x="278.05097380402333" y="367.1318395202326" font-size="1rem" fill="white">成長率</text><text x="421.56527605759334" y="364.6318395202326" font-size="1rem" fill="white"></text><text x="1" y="539.8659704178647" font-size="1rem" fill="white">門票收入</text><text x="1" y="820.1056972855417" font-size="1rem" fill="white">遊客人次</text><text x="257.13345503487426" y="539.8659704178647" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="342.75883697570447" y="539.8659704178647" font-size="1rem" fill="white">增減數</text><text x="257.13345503487426" y="779.9612094919355" font-size="1rem" fill="white">成長率</text><text x="421.56527605759334" y="777.4612094919355" font-size="1rem" fill="white"></text><text x="439.0652760575933" y="90" font-size="1rem" fill="white">門票收入</text><text x="439.0652760575933" y="197.39805793794005" font-size="1rem" fill="white">遊客人次</text><text x="614.0578668553194" y="90" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="614.0578668553194" y="199.29247774837603" font-size="1rem" fill="white">增減數</text><text x="789.0504576530454" y="90" font-size="1rem" fill="white">成長率</text><text x="786.5504576530454" y="303.99324840673023" font-size="1rem" fill="white"></text><text x="439.0652760575933" y="341.49324840673006" font-size="1rem" fill="white">門票收入</text><text x="439.0652760575933" y="540.9183395069435" font-size="1rem" fill="white">遊客人次</text><text x="668.7519649668267" y="341.49324840673006" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="780.4818352611139" y="341.49324840673006" font-size="1rem" fill="white">增減數</text><text x="668.7519649668267" y="545.208114041969" font-size="1rem" fill="white">成長率</text><text x="873.3602504137048" y="542.708114041969" font-size="1rem" fill="white"></text><text x="439.0652760575933" y="674.5445743728937" font-size="1rem" fill="white">門票收入</text><text x="439.0652760575933" y="781.6605272072792" font-size="1rem" fill="white">遊客人次</text><text x="615.3892065391173" y="674.5445743728937" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="615.3892065391173" y="790.6976367365266" font-size="1rem" fill="white">增減數</text><text x="791.7131370206413" y="674.5445743728937" font-size="1rem" fill="white">成長率</text><text x="789.2131370206413" y="896.5" font-size="1rem" fill="white"></text><text x="890.8602504137048" y="90" font-size="1rem" fill="white">門票收入</text><text x="890.8602504137048" y="206.14896773298943" font-size="1rem" fill="white">遊客人次</text><text x="1054.819766883562" y="90" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1180.1479496535665" y="90" font-size="1rem" fill="white">增減數</text><text x="1054.819766883562" y="255.146929090595" font-size="1rem" fill="white">成長率</text><text x="1294.3859637985165" y="255.146929090595" font-size="1rem" fill="white"></text><text x="890.8602504137048" y="368.8192665961747" font-size="1rem" fill="white">門票收入</text><text x="890.8602504137048" y="484.62186900164824" font-size="1rem" fill="white">遊客人次</text><text x="1056.0594716377088" y="368.8192665961747" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1184.7057974468958" y="368.8192665961747" font-size="1rem" fill="white">增減數</text><text x="1056.0594716377088" y="542.3413025564278" font-size="1rem" fill="white">成長率</text><text x="1294.3859637985165" y="539.8413025564278" font-size="1rem" fill="white"></text><text x="890.8602504137048" y="656.7787110977038" font-size="1rem" fill="white">門票收入</text><text x="890.8602504137048" y="772.9904131446438" font-size="1rem" fill="white">遊客人次</text><text x="1054.5956611563097" y="656.7787110977038" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1054.5956611563097" y="785.8615545461256" font-size="1rem" fill="white">增減數</text><text x="1218.3310718989146" y="656.7787110977038" font-size="1rem" fill="white">成長率</text><text x="1218.3310718989146" y="896.5" font-size="1rem" fill="white"></text><text x="1311.8859637985165" y="90" font-size="1rem" fill="white">門票收入</text><text x="1440.2146229139503" y="90" font-size="1rem" fill="white">遊客人次</text><text x="1311.8859637985165" y="242.96000432444424" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1311.8859637985165" y="371.5256278817959" font-size="1rem" fill="white">增減數</text><text x="1511.7176097237452" y="242.96000432444424" font-size="1rem" fill="white">成長率</text><text x="1509.2176097237452" y="461.4184352503066" font-size="1rem" fill="white"></text><text x="1615.5528419669736" y="90" font-size="1rem" fill="white">門票收入</text><text x="1745.9023950606975" y="90" font-size="1rem" fill="white">遊客人次</text><text x="1615.5528419669736" y="239.87983097522527" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1615.5528419669736" y="352.82607978474323" font-size="1rem" fill="white">增減數</text><text x="1791.796644434213" y="239.87983097522527" font-size="1rem" fill="white">成長率</text><text x="1789.296644434213" y="461.41843525030663" font-size="1rem" fill="white"></text><text x="1311.8859637985165" y="498.91843525030663" font-size="1rem" fill="white">門票收入</text><text x="1311.8859637985165" y="614.7379200373474" font-size="1rem" fill="white">遊客人次</text><text x="1475.7850640551083" y="498.91843525030663" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1475.7850640551083" y="623.6673754584384" font-size="1rem" fill="white">增減數</text><text x="1639.6841643117" y="498.91843525030663" font-size="1rem" fill="white">成長率</text><text x="1639.6841643117" y="733.8730363628445" font-size="1rem" fill="white"></text><text x="1311.8859637985165" y="771.3730363628445" font-size="1rem" fill="white">門票收入</text><text x="1445.8163749052123" y="771.3730363628445" font-size="1rem" fill="white">遊客人次</text><text x="1585.6943461607625" y="771.3730363628445" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1717.1247572674583" y="771.3730363628445" font-size="1rem" fill="white"></text><text x="1717.1247572674583" y="771.3730363628445" font-size="1rem" fill="white"></text><text x="1717.1247572674583" y="771.3730363628445" font-size="1rem" fill="white"></text><text x="1734.6247572674583" y="498.91843525030663" font-size="1rem" fill="white">門票收入</text><text x="1734.6247572674583" y="629.2107574547275" font-size="1rem" fill="white">遊客人次</text><text x="1734.6247572674583" y="768.7076777955782" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="1876.5" y="768.7076777955782" font-size="1rem" fill="white"></text><text x="1876.5" y="768.7076777955782" font-size="1rem" fill="white"></text><text x="1876.5" y="768.7076777955782" font-size="1rem" fill="white"></text><text x="1" y="105" font-size=".9rem" fill="white">5337819</text><text x="1" y="446.4021534366699" font-size=".9rem" fill="white">17290</text><text x="278.05097380402333" y="105" font-size=".9rem" fill="white">43941</text><text x="278.05097380402333" y="246.9385584379147" font-size=".9rem" fill="white">-26651</text><text x="278.05097380402333" y="382.1318395202326" font-size=".9rem" fill="white">-60</text><text x="421.56527605759334" y="379.6318395202326" font-size=".9rem" fill="white"></text><text x="1" y="554.8659704178647" font-size=".9rem" fill="white">3765267</text><text x="1" y="835.1056972855417" font-size=".9rem" fill="white">24330</text><text x="257.13345503487426" y="554.8659704178647" font-size=".9rem" fill="white">49775</text><text x="342.75883697570447" y="554.8659704178647" font-size=".9rem" fill="white">-25445</text><text x="257.13345503487426" y="794.9612094919355" font-size=".9rem" fill="white">-51</text><text x="421.56527605759334" y="792.4612094919355" font-size=".9rem" fill="white"></text><text x="439.0652760575933" y="105" font-size=".9rem" fill="white">0</text><text x="439.0652760575933" y="212.39805793794005" font-size=".9rem" fill="white">22779</text><text x="614.0578668553194" y="105" font-size=".9rem" fill="white">25427</text><text x="614.0578668553194" y="214.29247774837603" font-size=".9rem" fill="white">-2648</text><text x="789.0504576530454" y="105" font-size=".9rem" fill="white">-10</text><text x="786.5504576530454" y="318.99324840673023" font-size=".9rem" fill="white"></text><text x="439.0652760575933" y="356.49324840673006" font-size=".9rem" fill="white">1938002</text><text x="439.0652760575933" y="555.9183395069435" font-size=".9rem" fill="white">229841</text><text x="668.7519649668267" y="356.49324840673006" font-size=".9rem" fill="white">237802</text><text x="780.4818352611139" y="356.49324840673006" font-size=".9rem" fill="white">-7961</text><text x="668.7519649668267" y="560.208114041969" font-size=".9rem" fill="white">-3</text><text x="873.3602504137048" y="557.708114041969" font-size=".9rem" fill="white"></text><text x="439.0652760575933" y="689.5445743728937" font-size=".9rem" fill="white">0</text><text x="439.0652760575933" y="796.6605272072792" font-size=".9rem" fill="white">137582</text><text x="615.3892065391173" y="689.5445743728937" font-size=".9rem" fill="white">121616</text><text x="615.3892065391173" y="805.6976367365266" font-size=".9rem" fill="white">15966</text><text x="791.7131370206413" y="689.5445743728937" font-size=".9rem" fill="white">13</text><text x="789.2131370206413" y="911.5" font-size=".9rem" fill="white"></text><text x="890.8602504137048" y="105" font-size=".9rem" fill="white">0</text><text x="890.8602504137048" y="221.14896773298943" font-size=".9rem" fill="white">142989</text><text x="1054.819766883562" y="105" font-size=".9rem" fill="white">125186</text><text x="1180.1479496535665" y="105" font-size=".9rem" fill="white">17803</text><text x="1054.819766883562" y="270.146929090595" font-size=".9rem" fill="white">14</text><text x="1294.3859637985165" y="270.146929090595" font-size=".9rem" fill="white"></text><text x="890.8602504137048" y="383.8192665961747" font-size=".9rem" fill="white">0</text><text x="890.8602504137048" y="499.62186900164824" font-size=".9rem" fill="white">265816</text><text x="1056.0594716377088" y="383.8192665961747" font-size=".9rem" fill="white">240556</text><text x="1184.7057974468958" y="383.8192665961747" font-size=".9rem" fill="white">25260</text><text x="1056.0594716377088" y="557.3413025564278" font-size=".9rem" fill="white">10</text><text x="1294.3859637985165" y="554.8413025564278" font-size=".9rem" fill="white"></text><text x="890.8602504137048" y="671.7787110977038" font-size=".9rem" fill="white">0</text><text x="890.8602504137048" y="787.9904131446438" font-size=".9rem" fill="white">121534</text><text x="1054.5956611563097" y="671.7787110977038" font-size=".9rem" fill="white">159655</text><text x="1054.5956611563097" y="800.8615545461256" font-size=".9rem" fill="white">-38121</text><text x="1218.3310718989146" y="671.7787110977038" font-size=".9rem" fill="white">-23</text><text x="1218.3310718989146" y="911.5" font-size=".9rem" fill="white"></text><text x="1311.8859637985165" y="105" font-size=".9rem" fill="white">0</text><text x="1440.2146229139503" y="105" font-size=".9rem" fill="white">359560</text><text x="1311.8859637985165" y="257.96000432444424" font-size=".9rem" fill="white">445198</text><text x="1311.8859637985165" y="386.5256278817959" font-size=".9rem" fill="white">-85638</text><text x="1511.7176097237452" y="257.96000432444424" font-size=".9rem" fill="white">-19</text><text x="1509.2176097237452" y="476.4184352503066" font-size=".9rem" fill="white"></text><text x="1615.5528419669736" y="105" font-size=".9rem" fill="white">0</text><text x="1745.9023950606975" y="105" font-size=".9rem" fill="white">30390</text><text x="1615.5528419669736" y="254.87983097522527" font-size=".9rem" fill="white">27249</text><text x="1615.5528419669736" y="367.82607978474323" font-size=".9rem" fill="white">3141</text><text x="1791.796644434213" y="254.87983097522527" font-size=".9rem" fill="white">11</text><text x="1789.296644434213" y="476.41843525030663" font-size=".9rem" fill="white"></text><text x="1311.8859637985165" y="513.9184352503066" font-size=".9rem" fill="white">0</text><text x="1311.8859637985165" y="629.7379200373474" font-size=".9rem" fill="white">72382</text><text x="1475.7850640551083" y="513.9184352503066" font-size=".9rem" fill="white">111137</text><text x="1475.7850640551083" y="638.6673754584384" font-size=".9rem" fill="white">-38755</text><text x="1639.6841643117" y="513.9184352503066" font-size=".9rem" fill="white">-34</text><text x="1639.6841643117" y="748.8730363628445" font-size=".9rem" fill="white"></text><text x="1311.8859637985165" y="786.3730363628445" font-size=".9rem" fill="white">0</text><text x="1445.8163749052123" y="786.3730363628445" font-size=".9rem" fill="white">64014</text><text x="1585.6943461607625" y="786.3730363628445" font-size=".9rem" fill="white">0</text><text x="1717.1247572674583" y="786.3730363628445" font-size=".9rem" fill="white"></text><text x="1717.1247572674583" y="786.3730363628445" font-size=".9rem" fill="white"></text><text x="1717.1247572674583" y="786.3730363628445" font-size=".9rem" fill="white"></text><text x="1734.6247572674583" y="513.9184352503066" font-size=".9rem" fill="white">0</text><text x="1734.6247572674583" y="644.2107574547275" font-size=".9rem" fill="white">101836</text><text x="1734.6247572674583" y="783.7076777955782" font-size=".9rem" fill="white">0</text><text x="1876.5" y="783.7076777955782" font-size=".9rem" fill="white"></text><text x="1876.5" y="783.7076777955782" font-size=".9rem" fill="white"></text><text x="1876.5" y="783.7076777955782" font-size=".9rem" fill="white"></text><text x="1" y="56" font-size="1.1rem" fill="black">小人國企業股份有限公司</text><text x="1" y="505.86597041786473" font-size="1.1rem" fill="black">埔心牧場</text><text x="439.0652760575933" y="56" font-size="1.1rem" fill="black">小烏來風景特定區</text><text x="439.0652760575933" y="307.49324840673006" font-size="1.1rem" fill="black">石門水庫</text><text x="439.0652760575933" y="640.5445743728937" font-size="1.1rem" fill="black">慈湖</text><text x="890.8602504137048" y="56" font-size="1.1rem" fill="black">角板山遊憩區</text><text x="890.8602504137048" y="334.8192665961747" font-size="1.1rem" fill="black">虎頭山風景特定區</text><text x="890.8602504137048" y="622.7787110977038" font-size="1.1rem" fill="black">竹圍漁港</text><text x="1311.8859637985165" y="56" font-size="1.1rem" fill="black">大溪老城區</text><text x="1615.5528419669736" y="56" font-size="1.1rem" fill="black">桃園市客家文化館</text><text x="1311.8859637985165" y="464.91843525030663" font-size="1.1rem" fill="black">永安漁港</text><text x="1311.8859637985165" y="737.3730363628445" font-size="1.1rem" fill="black">新屋綠色走廊</text><text x="1734.6247572674583" y="464.91843525030663" font-size="1.1rem" fill="black">觀音蓮花園休閒農業區</text></g></svg></div></div>



		<script>
			var Base64 = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (r) { var t, e, o, a, h, c, n = "", d = 0; for (r = Base64._utf8_encode(r); d < r.length;)o = (c = r.charCodeAt(d++)) >> 2, a = (3 & c) << 4 | (t = r.charCodeAt(d++)) >> 4, h = (15 & t) << 2 | (e = r.charCodeAt(d++)) >> 6, c = 63 & e, isNaN(t) ? h = c = 64 : isNaN(e) && (c = 64), n = n + this._keyStr.charAt(o) + this._keyStr.charAt(a) + this._keyStr.charAt(h) + this._keyStr.charAt(c); return n }, decode: function (r) { var t, e, o, a, h, c = "", n = 0; for (r = r.replace(/[^A-Za-z0-9\+\/\=]/g, ""); n < r.length;)t = this._keyStr.indexOf(r.charAt(n++)) << 2 | (o = this._keyStr.indexOf(r.charAt(n++))) >> 4, e = (15 & o) << 4 | (a = this._keyStr.indexOf(r.charAt(n++))) >> 2, o = (3 & a) << 6 | (h = this._keyStr.indexOf(r.charAt(n++))), c += String.fromCharCode(t), 64 != a && (c += String.fromCharCode(e)), 64 != h && (c += String.fromCharCode(o)); return c = Base64._utf8_decode(c) }, _utf8_encode: function (r) { r = r.replace(/\r\n/g, "\n"); for (var t = "", e = 0; e < r.length; e++) { var o = r.charCodeAt(e); o < 128 ? t += String.fromCharCode(o) : (127 < o && o < 2048 ? t += String.fromCharCode(o >> 6 | 192) : (t += String.fromCharCode(o >> 12 | 224), t += String.fromCharCode(o >> 6 & 63 | 128)), t += String.fromCharCode(63 & o | 128)) } return t }, _utf8_decode: function (r) { for (var t = "", e = 0, o = c1 = c2 = 0; e < r.length;)(o = r.charCodeAt(e)) < 128 ? (t += String.fromCharCode(o), e++) : 191 < o && o < 224 ? (c2 = r.charCodeAt(e + 1), t += String.fromCharCode((31 & o) << 6 | 63 & c2), e += 2) : (c2 = r.charCodeAt(e + 1), c3 = r.charCodeAt(e + 2), t += String.fromCharCode((15 & o) << 12 | (63 & c2) << 6 | 63 & c3), e += 3); return t } };
		</script>

		<script>
			var csvData = null
			window.addEventListener('load', function(){
                var treemapContainer = document.getElementById('treemap')
                var objectKeys = document.getElementById("ObjectKeys")

                document.getElementById("ObjectKeys").addEventListener('change', function(evt){
					if(evt.target.value == 'selectValue' ){
						return;
					}

                    //clear container
                    if (treemapContainer.innerHTML.length) {
                        treemapContainer.innerHTML = ''
                    }


                    dataClassifier(objectKeys.value, function(data, layers){
                        node = getNode(data, layers, treemapContainer)
                        treemapContainer.appendChild(node)
                    })
				})

				document.getElementById('dropfile').addEventListener('dragover',function(evt){
					evt.preventDefault()
				})

				document.getElementById('dropfile').addEventListener('drop', function(evt){
					evt.preventDefault()

					var files = evt.dataTransfer.files

					if (files.length) {
                        if (treemapContainer.innerHTML.length) {
                            treemapContainer.innerHTML = ''
                        }

                        if (objectKeys.innerHTML.length) {
                            objectKeys.innerHTML = ''
						}

						var csvFile = files[0]

						//讀取csv
						var fr = new FileReader()

                        fr.onload = function(){
                            dataLoader(fr.result, function(){
								dataClassifier(objectKeys.value, function(data, layers){
									node = getNode(data, layers, treemapContainer)
									treemapContainer.innerHTML = node.innerHTML
								})
							})
                        }

						fr.readAsText(csvFile)
					}
				})
			})
		</script>




</body></html>
